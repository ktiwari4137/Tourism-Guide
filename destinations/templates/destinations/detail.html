{% extends 'base.html' %}
{% load static %}

{% block title %}{{ destination.name }} - Tourism Guide{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="relative h-[70vh] bg-cover bg-center" style="background-image: url('{{ destination.image.url }}');">
    <div class="absolute inset-0 bg-gradient-to-b from-black/60 to-black/30"></div>
    <div class="relative container mx-auto px-6 h-full flex items-center">
        <div class="max-w-2xl text-white">
            <h1 class="text-5xl md:text-6xl font-bold mb-6">{{ destination.name }}</h1>
            <div class="flex flex-wrap items-center gap-4 mb-6">
                <span class="inline-flex items-center bg-white/10 backdrop-blur-sm px-4 py-2 rounded-xl">
                    <i class="fas fa-map-marker-alt mr-2"></i>
                    {{ destination.country }}
                </span>
                <span class="inline-flex items-center bg-white/10 backdrop-blur-sm px-4 py-2 rounded-xl">
                    <i class="fas fa-thermometer-half mr-2"></i>
                    {{ destination.climate }}
                </span>
                <span class="inline-flex items-center bg-white/10 backdrop-blur-sm px-4 py-2 rounded-xl">
                    <i class="fas fa-star text-yellow-400 mr-2"></i>
                    {{ destination.rating }} ({{ destination.review_count }} reviews)
                </span>
            </div>
            {% if user.is_authenticated and user.is_staff %}
            <div class="flex gap-4">
                <a href="{% url 'destinations:update' destination.slug %}" 
                   class="inline-flex items-center px-4 py-2 bg-white/10 backdrop-blur-sm text-white rounded-xl hover:bg-white/20 transition-colors">
                    <i class="fas fa-edit mr-2"></i>
                    Edit
                </a>
                <button onclick="confirmDelete()" 
                   class="inline-flex items-center px-4 py-2 bg-red-600 text-white rounded-xl hover:bg-red-700 transition-colors">
                    <i class="fas fa-trash mr-2"></i>
                    Delete
                </button>
            </div>
            {% endif %}
        </div>
    </div>
</section>

<!-- Delete Confirmation Modal -->
<div id="deleteModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
    <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4">
        <h3 class="text-2xl font-bold mb-4">Confirm Delete</h3>
        <p class="text-gray-600 mb-6">Are you sure you want to delete "{{ destination.name }}"? This action cannot be undone.</p>
        <div class="flex justify-end space-x-4">
            <button onclick="closeModal()" class="px-6 py-2 border border-gray-300 rounded-xl text-gray-700 hover:bg-gray-50">
                Cancel
            </button>
            <a href="{% url 'destinations:delete' destination.slug %}" 
               class="px-6 py-2 bg-red-600 text-white rounded-xl hover:bg-red-700">
                Delete
            </a>
        </div>
    </div>
</div>

<script>
function confirmDelete() {
    document.getElementById('deleteModal').classList.remove('hidden');
    document.getElementById('deleteModal').classList.add('flex');
}

function closeModal() {
    document.getElementById('deleteModal').classList.add('hidden');
    document.getElementById('deleteModal').classList.remove('flex');
}
</script>

<!-- Main Content -->
<section class="py-16">
    <div class="container mx-auto px-6">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Left Column -->
            <div class="lg:col-span-2">
                <!-- Description -->
                <div class="bg-white rounded-2xl shadow-lg p-8 mb-8">
                    <h2 class="text-3xl font-bold mb-6">About {{ destination.name }}</h2>
                    <div class="prose max-w-none text-gray-600">
                        {{ destination.description|linebreaks }}
                    </div>
                </div>

                <!-- Image Gallery -->
                <div class="bg-white rounded-2xl shadow-lg p-8 mb-8">
                    <h2 class="text-3xl font-bold mb-6">Photo Gallery</h2>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-6">
                        {% for image in destination.images.all %}
                        <div class="group relative aspect-w-16 aspect-h-9 rounded-xl overflow-hidden">
                            <img src="{{ image.image.url }}" alt="{{ destination.name }}" class="w-full h-full object-cover transition duration-300 group-hover:scale-110">
                            <div class="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition duration-300 flex items-center justify-center">
                                <button class="text-white text-2xl">
                                    <i class="fas fa-expand"></i>
                                </button>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>

                <!-- Attractions -->
                <div class="bg-white rounded-2xl shadow-lg p-8">
                    <h2 class="text-3xl font-bold mb-6">Top Attractions</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        {% for attraction in destination.attractions.all %}
                        <div class="group bg-gray-50 rounded-xl overflow-hidden hover:shadow-lg transition duration-300">
                            <div class="relative h-48 overflow-hidden">
                                <img src="{{ attraction.image.url }}" alt="{{ attraction.name }}" class="w-full h-full object-cover transition duration-300 group-hover:scale-110">
                            </div>
                            <div class="p-6">
                                <h3 class="text-xl font-bold mb-2">{{ attraction.name }}</h3>
                                <p class="text-gray-600 mb-4 line-clamp-2">{{ attraction.description }}</p>
                                <a href="#" class="inline-flex items-center text-emerald-600 hover:text-emerald-700 font-semibold group">
                                    Learn more
                                    <i class="fas fa-arrow-right ml-2 transform group-hover:translate-x-1 transition duration-300"></i>
                                </a>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <!-- Right Column -->
            <div class="lg:col-span-1">
                <!-- Weather Widget -->
                <div class="bg-white rounded-2xl shadow-lg p-8 mb-8">
                    <h2 class="text-2xl font-bold mb-6">Current Weather</h2>
                    <div class="text-center">
                        <div class="text-7xl mb-6">
                            <i class="fas fa-sun text-yellow-400"></i>
                        </div>
                        <div class="text-5xl font-bold mb-2">24Â°C</div>
                        <div class="text-gray-600 mb-6">Sunny</div>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div class="bg-gray-50 rounded-xl p-4">
                                <div class="text-gray-600 mb-1">Humidity</div>
                                <div class="font-semibold">65%</div>
                            </div>
                            <div class="bg-gray-50 rounded-xl p-4">
                                <div class="text-gray-600 mb-1">Wind</div>
                                <div class="font-semibold">12 km/h</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Available Packages -->
                <div class="bg-white rounded-2xl shadow-lg p-8">
                    <h2 class="text-2xl font-bold mb-6">Available Packages</h2>
                    <div class="space-y-6">
                        {% for package in destination.packages.all %}
                        <div class="group bg-gray-50 rounded-xl p-6 hover:shadow-lg transition duration-300">
                            <h3 class="text-xl font-bold mb-2">{{ package.name }}</h3>
                            <p class="text-gray-600 mb-4 line-clamp-2">{{ package.description }}</p>
                            <div class="flex justify-between items-center">
                                <span class="text-2xl font-bold text-emerald-600">${{ package.price }}</span>
                                <a href="{% url 'packages:detail' package.slug %}" class="inline-flex items-center text-emerald-600 hover:text-emerald-700 font-semibold group">
                                    View
                                    <i class="fas fa-arrow-right ml-2 transform group-hover:translate-x-1 transition duration-300"></i>
                                </a>
                            </div>
                        </div>
                        {% empty %}
                        <div class="text-center py-8">
                            <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-gray-100 mb-4">
                                <i class="fas fa-box-open text-2xl text-gray-400"></i>
                            </div>
                            <p class="text-gray-600">No packages available at the moment.</p>
                        </div>
                        {% endfor %}
                    </div>
                </div>

                <!-- Wishlist Button -->
                <div class="bg-white rounded-2xl shadow-lg p-8 mt-8">
                    <h2 class="text-2xl font-bold mb-6">Wishlist</h2>
                    <div class="flex items-center justify-between">
                        {% if user.is_authenticated %}
                            {% if destination in user.wishlist_destinations.all %}
                                <form method="post" action="{% url 'destinations:remove_from_wishlist' destination.slug %}" class="inline">
                                    {% csrf_token %}
                                    <button type="submit" class="text-red-600 hover:text-red-700">
                                        <i class="fas fa-heart"></i> Remove from Wishlist
                                    </button>
                                </form>
                            {% else %}
                                <form method="post" action="{% url 'destinations:add_to_wishlist' destination.slug %}" class="inline">
                                    {% csrf_token %}
                                    <button type="submit" class="text-emerald-600 hover:text-emerald-700">
                                        <i class="far fa-heart"></i> Add to Wishlist
                                    </button>
                                </form>
                            {% endif %}
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %} 